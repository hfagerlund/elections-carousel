/*!
 * elections-carousel
 * @copyright (c) Heini Fagerlund
 * @version 0.4.0
 * @license MIT
 */
(function(){"use strict";if(!window.BoD){window.BoD={}}var e=10;var t=500;var n=300;var a=document.getElementById("eResults");var r=0;var o=0;var i=0;var s=0;var l=e*t;var d=-(l-1*t);var c=0;function u(e,t,n){$("#"+e).animate({left:t},n,function(){})}window.BoD.rotateCarousel=u;function p(e){var t=document.styleSheets[0];var n=t.cssRules.length;jQuery(".btn--"+e).addClass("btn_disabled");t.insertRule(".btn_disabled{animation:none!important;background-color:#cccccc!important;cursor:text!important}",n)}window.BoD.disableBtn=p;function v(e,a){i=e=="btnBack"?s+(o+1)*t:s-(r+1)*t;var l=e=="btnBack"?"back":e=="btnNext"?"next":"";if(i>=d&&i<=c){jQuery(".btn--"+l).removeClass("btn_disabled");if(i===c||i===d){BoD.disableBtn(l)}BoD.rotateCarousel("wrapper",i,n)}else if(i>c&&e=="btnBack"){BoD.disableBtn(l);i=c}else if(i<d&&e=="btnNext"){BoD.disableBtn(l);i=d}if(i<=c-1*t&&e=="btnNext"){jQuery(".btn--back").removeClass("btn_disabled")}if(i>=d+1*t&&e=="btnBack"){jQuery(".btn--next").removeClass("btn_disabled")}s=i;if(e=="btnBack"){o=0}else if(e=="btnNext"){r=0}return i}window.BoD.btnClick=v;function f(e,t){var n=document.createElement("a");n.setAttribute("class","btn "+t);n.setAttribute("href","#");n.innerHTML=t==="btn--back"?"&lsaquo;":"&rsaquo;";a.appendChild(n);BoD.disableBtn("back");n.addEventListener("click",function(t){var n=t.target;BoD.btnClick(e,n);t.preventDefault()},false)}window.BoD.createBtn=f;function b(e){var t=[];var n=e.map(function(e){return e.votes});var a=n.reduce(function(e,t){return e+t},0);t.push(n.reduce(function(e,t){return e+t},0));return t.shift()}window.BoD.calcTotalVotesForRiding=b;function B(e){return+(Math.round(e+"e+2")+"e-2")}window.BoD.roundToTwoDec=B;function g(e){jQuery("#eResults").html("");var t=e.map(function(e){return e});t.forEach(function(e){var t="art_"+e.id;var n=e.name;jQuery("#eResults").append('<article id="'+t+'" class="riding"><header><h2>Riding of: '+n+"</h2></header></article>");var a=jQuery("#"+t);a.append('<ol class="riding__list"></ol>');var r=a.children("ol")});jQuery(".riding").wrapAll('<div id="wrapper"></div>');BoD.createBtn("btnBack","btn--back");BoD.createBtn("btnNext","btn--next");var n=e.map(function(e){return e.results});jQuery(".riding").children("ol").after('<p class="riding__totalVotes">Total votes for this riding: <strong>'+"</strong> votes</p>");var a=0;n.forEach(function(e){a+=1;var t=BoD.calcTotalVotesForRiding(e);jQuery("#art_"+a).children(".riding__totalVotes").children("strong").append(t);var n=[];var r=[];for(var o in e){var i={name:e[o].name,partyId:e[o].partyId,votes:e[o].votes,isElected:e[o].isElected,partyCode:e[o].partyCode};var s=BoD.roundToTwoDec(i.votes/t*100);i.percentageVotes=s;var l=jQuery("#art_"+a);var d=l.children("ol");n.push(i)}r.push(n.sort(function(e,t){return t.votes-e.votes}));for(var c in r){for(var u in r[c]){var p=r[c][u];var v=p.isElected?" riding_winner":"";var f=document.styleSheets[0];var b=f.cssRules.length;var B=250*(p.percentageVotes/100);f.insertRule("#art_"+a+" .riding__candidate_"+p.partyCode.toLowerCase()+"{height:"+B+"px!important;position:relative}",b);jQuery("#art_"+a).children("ol").append('<li class="riding__candidate riding__candidate_'+p.partyCode.toLowerCase()+v+'"><span class="percentage"><span class="cap">'+p.partyCode.toLowerCase()+"</span> "+p.percentageVotes+"%</span></li>");var g=p.isElected?" was elected with ":" won ";var w=jQuery("#art_"+a).children(".riding__totalVotes");w.before('<p class="pointForm"><span class="label cap riding__candidate_'+p.partyCode.toLowerCase()+v+'"> '+p.partyCode.toLowerCase()+" </span> "+p.name+g+p.votes+" votes</p>")}}});var r=jQuery(".riding__list .riding_winner");r.prepend("Elected ")}window.BoD.createResultsListFunc=g;function w(){if(!document.getElementsByTagName)return false;if(!document.getElementById)return false;if(!document.getElementById("eResults"))return false}window.BoD.initializeCarousel=w})();jQuery("html").addClass("js");var url="http://localhost:8080/results.js";jQuery.ajax({type:"GET",url:url,contentType:"application/json; charset=UTF-8",jsonpCallback:"gNews_getRidingDetailsCallback",dataType:"jsonp",success:BoD.createResultsListFunc});document.addEventListener("DOMContentLoaded",function(){BoD.initializeCarousel()});